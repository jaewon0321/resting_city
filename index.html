<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>안식의 도시</title>

  <style>
    :root{
      --bg: #0b1020;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.09);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.70);
      --line: rgba(255,255,255,.14);
      --accent: #86b7ff;
      --shadow: 0 12px 40px rgba(0,0,0,.35);
      --radius: 16px;
      --radius2: 12px;

      /* 반응형 스케일 */
      --wrap: 1160px;     /* PC 최대 폭 */
      --gap: 12px;        /* 기본 간격 */
      --cell-min-h: 120px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(1000px 600px at 10% -10%, rgba(134,183,255,.22), transparent 60%),
        radial-gradient(900px 500px at 100% 10%, rgba(199,148,255,.18), transparent 55%),
        radial-gradient(900px 700px at 40% 110%, rgba(120,255,214,.10), transparent 55%),
        var(--bg);
      overflow-x: hidden;
    }

    /* 컨테이너 */
    .wrap{
      max-width: var(--wrap);
      margin: 0 auto;
      padding: clamp(18px, 2.2vw, 28px) clamp(14px, 2vw, 18px) 90px;
    }

    /* 헤더 (모바일에서도 깔끔하게 줄바꿈) */
    header{
      position: sticky;
      top: 0;
      z-index: 10;
      padding: 12px 0 10px;
      backdrop-filter: blur(10px);
      background: linear-gradient(to bottom, rgba(11,16,32,.92), rgba(11,16,32,.45));
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .header-inner{
      max-width: var(--wrap);
      margin: 0 auto;
      padding: 0 clamp(14px, 2vw, 18px);
      display:flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap; /* ✅ 모바일에서 툴바가 아래로 내려가게 */
    }

    .brand{
      display:flex;
      flex-direction: column;
      gap: 6px;
      min-width: 220px;
      flex: 1 1 280px;
    }

    h1{
      margin:0;
      font-size: clamp(18px, 2.2vw, 22px);
      letter-spacing: .2px;
      line-height: 1.15;
    }
    .subtitle{
      font-size: clamp(12px, 1.4vw, 13px);
      color: var(--muted);
      line-height: 1.35;
    }

    .toolbar{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap: wrap;
      flex: 1 1 360px;
    }

    .pill{
      display:flex;
      align-items:center;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 24px rgba(0,0,0,.18);
      flex: 1 1 260px; /* ✅ 모바일에서도 검색창이 넓게 */
      min-width: 240px;
    }
    .pill label{
      font-size: 12px;
      color: var(--muted);
      user-select:none;
      white-space: nowrap;
    }
    .pill input{
      width: 100%;
      background: transparent;
      border: 0;
      outline: none;
      color: var(--text);
      font-size: 13px;
      min-width: 120px;
    }

    .btn{
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 999px;
      font-size: 12px;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      user-select:none;
      flex: 0 0 auto;
      white-space: nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.09);
      border-color: rgba(255,255,255,.18);
    }

    main{ padding-top: 14px; }

    /* TOC: 모바일/태블릿/PC 자동 컬럼 */
    .toc{
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr)); /* PC 기본 4 */
      gap: var(--gap);
      margin: 10px 0 20px;
    }
    .toc a{
      text-decoration:none;
      color: var(--text);
      background: var(--panel);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      padding: 12px 12px;
      display:flex;
      justify-content: space-between;
      gap: 10px;
      align-items:center;
      box-shadow: 0 10px 26px rgba(0,0,0,.18);
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      min-height: 56px;
    }
    .toc a:hover{
      transform: translateY(-2px);
      background: rgba(255,255,255,.08);
      border-color: rgba(134,183,255,.35);
    }
    .toc .left{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .toc .code{
      font-weight: 700;
      color: rgba(134,183,255,.95);
      font-size: 12px;
      letter-spacing: .4px;
    }
    .toc .name{
      font-size: 13px;
      color: rgba(255,255,255,.92);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .toc .arrow{ color: rgba(255,255,255,.55); font-size: 14px; flex: 0 0 auto; }

    /* 카드 */
    .card{
      background: var(--panel);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      margin: 12px 0 18px;
    }
    .card-head{
      display:flex;
      justify-content: space-between;
      gap: 12px;
      align-items: baseline;
      padding: 16px 16px 10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(to bottom, rgba(255,255,255,.06), rgba(255,255,255,.03));
      flex-wrap: wrap; /* ✅ 모바일에서 meta 줄바꿈 */
    }
    .card-head h2{
      margin:0;
      font-size: clamp(14px, 1.8vw, 16px);
      line-height: 1.2;
    }
    .meta{
      color: var(--muted);
      font-size: 12px;
      white-space: nowrap;
    }

    details{ padding: 0 16px 16px; }
    summary{
      list-style: none;
      cursor: pointer;
      padding: 14px 12px;
      margin: 12px 0 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 14px;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 10px;
      user-select:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .sum-left{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .sum-title{ font-size: 13px; font-weight: 650; }
    .sum-sub{ font-size: 12px; color: var(--muted); }
    .chev{
      font-size: 14px;
      color: rgba(255,255,255,.65);
      transition: transform .15s ease;
      flex: 0 0 auto;
    }
    details[open] .chev{ transform: rotate(90deg); }

    /* ✅ 핵심: 이미지 그리드 반응형
       - PC: 5열
       - 태블릿: 4열
       - 모바일: 2열
       - 아주 작은 모바일: 1열 (선택) */
    .grid{
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
      padding: 10px;
      background: rgba(0,0,0,.18);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius2);
    }

    .cell{
      position: relative;
      border-radius: 12px;
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      min-height: var(--cell-min-h);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .cell img{
      width: 100%;
      height: 100%;
      object-fit: cover;
      display:block;
      transform: translateZ(0);
    }
    .badge{
      position:absolute;
      left: 8px;
      top: 8px;
      padding: 4px 8px;
      font-size: 11px;
      color: rgba(255,255,255,.9);
      background: rgba(0,0,0,.40);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 999px;
      backdrop-filter: blur(6px);
    }
    .empty{
      color: rgba(255,255,255,.45);
      font-size: 12px;
      text-align:center;
      padding: 10px;
    }

    .footer-note{
      margin-top: 22px;
      color: rgba(255,255,255,.60);
      font-size: 12px;
      line-height: 1.6;
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
    }

    /* ✅ 태블릿 */
    @media (max-width: 1024px){
      :root{ --cell-min-h: 132px; --gap: 10px; }
      .toc{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .grid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
      .meta{ white-space: normal; }
    }

    /* ✅ 모바일 */
    @media (max-width: 640px){
      :root{ --cell-min-h: 150px; }
      .toc{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      summary{ padding: 12px 10px; }
      details{ padding: 0 14px 14px; }
      .card-head{ padding: 14px 14px 10px; }
      .pill{ min-width: 100%; } /* 검색창 한 줄 꽉 */
      .btn{ flex: 1 1 auto; text-align:center; } /* 버튼 두 개 나란히 */
    }

    /* ✅ 아주 작은 모바일 (선택): 1열로 */
    @media (max-width: 380px){
      .toc{ grid-template-columns: 1fr; }
      .grid{ grid-template-columns: 1fr; }
      :root{ --cell-min-h: 180px; }
    }
  </style>
</head>

<body>
  <header>
    <div class="header-inner">
      <div class="brand">
        <h1>안식의 도시</h1>
      </div>

      <div class="toolbar">
        <div class="pill">
          <label for="q">검색</label>
          <input id="q" type="search" placeholder="이름/코드로 필터…" autocomplete="off" />
        </div>
        <button class="btn" id="openAll" type="button">모두 펼치기</button>
        <button class="btn" id="closeAll" type="button">모두 접기</button>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main>
      <section class="toc" id="toc"></section>
      <section id="cards"></section>
    </main>
  </div>

  <script>
    const characters = [
      { code: "A", name: "안젤라 로시" },
      { code: "B", name: "후지사와 린" },
      { code: "C", name: "강무연" },
      { code: "D", name: "루 샤오위" },
      { code: "E", name: "아야" },
      { code: "F", name: "카미" },       // 70번째 = 99.webp
      { code: "G", name: "루나" },
      { code: "H", name: "이리스" },
      { code: "I", name: "사라 레비" },
      { code: "J", name: "미즈키 아오" },
      { code: "K", name: "엘리나" },
      { code: "L", name: "레이브" },
      { code: "M", name: "쿠로" },
      { code: "N", name: "시로 우사기" },
      { code: "O", name: "헬" },         // 70번째 = 99.webp
    ];

    const BASE = "https://itimg.kr/1023/EAD";
    const special70 = new Set(["F", "O"]); // 카미/헬만 70번째=99.webp

    const tocEl = document.getElementById("toc");
    const cardsEl = document.getElementById("cards");

    function makeTOCItem({code, name}) {
      const a = document.createElement("a");
      a.href = `#char-${code}`;
      a.dataset.code = code;
      a.dataset.name = name;
      a.innerHTML = `
        <div class="left">
          <div class="code">${code}</div>
          <div class="name">${name}</div>
        </div>
        <div class="arrow">›</div>
      `;
      return a;
    }

    function makeImageCell(code, name, label, fileNo) {
      const cell = document.createElement("div");
      cell.className = "cell";

      const img = document.createElement("img");
      img.loading = "lazy";
      img.decoding = "async";
      img.referrerPolicy = "no-referrer";
      img.alt = `${code} ${name} ${label}`;
      img.src = `${BASE}/${code}/${fileNo}.webp`;

      const badge = document.createElement("div");
      badge.className = "badge";
      badge.textContent = `${label}`;

      cell.appendChild(img);
      cell.appendChild(badge);
      return cell;
    }

    function makeCard({code, name}) {
  const card = document.createElement("article");
  card.className = "card";
  card.id = `char-${code}`;
  card.dataset.code = code.toLowerCase();
  card.dataset.name = name.toLowerCase();

  const details = document.createElement("details");
  details.dataset.details = "1";

  const summary = document.createElement("summary");
  summary.innerHTML = `
    <div class="sum-left">
      <div class="sum-title">이미지 시트</div>
    </div>
    <div class="chev">›</div>
  `;

  const grid = document.createElement("div");
  grid.className = "grid";

  // ✅ 1~70.webp 출력
  for (let i = 1; i <= 70; i++) {
    grid.appendChild(makeImageCell(code, name, i, i));
  }

  // ✅ 71번째 칸에 99.webp (카미/헬만)
  if (special70.has(code)) {
    grid.appendChild(makeImageCell(code, name, 71, 99));
  }

  details.appendChild(summary);
  details.appendChild(grid);

  card.innerHTML = `
    <div class="card-head">
      <h2>${code}.${name}</h2>
      <div class="meta">IMG: 1~70${special70.has(code) ? " + (71=99.webp)" : ""}</div>
    </div>
  `;
  card.appendChild(details);
  return card;
}

    // 렌더
    characters.forEach(c => {
      tocEl.appendChild(makeTOCItem(c));
      cardsEl.appendChild(makeCard(c));
    });

    // 검색 필터
    const q = document.getElementById("q");
    q.addEventListener("input", () => {
      const term = q.value.trim().toLowerCase();
      const cards = [...cardsEl.querySelectorAll(".card")];
      const tocItems = [...tocEl.querySelectorAll("a")];

      cards.forEach(card => {
        const hit = !term || card.dataset.code.includes(term) || card.dataset.name.includes(term);
        card.style.display = hit ? "" : "none";
      });

      tocItems.forEach(a => {
        const hit = !term || a.dataset.code.toLowerCase().includes(term) || a.dataset.name.toLowerCase().includes(term);
        a.style.display = hit ? "" : "none";
      });
    });

    // 모두 펼치기/접기
    document.getElementById("openAll").addEventListener("click", () => {
      document.querySelectorAll('details[data-details="1"]').forEach(d => d.open = true);
    });
    document.getElementById("closeAll").addEventListener("click", () => {
      document.querySelectorAll('details[data-details="1"]').forEach(d => d.open = false);
    });

    // 해시로 들어왔을 때 자동 펼치기
    window.addEventListener("DOMContentLoaded", () => {
      const hash = location.hash;
      if (!hash) return;
      const target = document.querySelector(hash);
      if (!target) return;
      const det = target.querySelector('details[data-details="1"]');
      if (det) det.open = true;
    });
  </script>
</body>
</html>

